<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0">
		<title>西柚计算机协会-会员信息</title>
		<style type="text/css">
			.side-nav a {
				display: block;
			}
			
			.side-nav a:hover {
				background-color: #EEEEEE !important;
			}
			/*.side-nav a:visited{
				background-color: black !important;
			}*/
		</style>
		<link rel="stylesheet" href="../res/layui/css/layui.css" />
		<link rel="stylesheet" href="../res/static/css/index.css" />
	</head>

	<body>
		<!--nav部分-->
		<div class="nav">
			<div class="layui-container">
				<!--协会logo-->
				<div class="nav-logo">
					<a href="index.html">
						<p class="title" style="font-size: 30px;">
							<img src="http://39.106.218.57/img/ico_001.png" alt="西柚计算机协会" /> 西柚计算机协会
						</p>
					</a>
				</div>
				<div class="nav-list">
					<button>
						<span></span><span></span><span></span>
					</button>
					<ul class="layui-nav" lay-filter="">
						<li class="layui-nav-item">
							<a href="activity.html">活动</a>
						</li>
						<li class="layui-nav-item">
							<a href="news.html">动态</a>
						</li>
						<li class="layui-nav-item">
							<a href="case.html">义诊</a>
						</li>
						<li class="layui-nav-item">
							<a href="about.html">关于</a>
						</li>
						<li class="layui-nav-item">
							<a href="#">资源</a>
						</li>
						<li class="layui-nav-item layui-this">
							<a href="member.html">会员中心</a>
						</li>
					</ul>
				</div>
			</div>
		</div>

		<!--main-->

		<div class="layui-container" style="margin-top: 120px; ">
			<ul class="layui-nav layui-nav-tree  side-nav" lay-filter="" style="height: 300px; float: left; background-color: rgb(238,238,238,0.5); color: black;">
				<!-- 侧边导航: <ul class="layui-nav layui-nav-tree layui-nav-side"> -->
				<li class="layui-nav-item ">
					<a href="memberNewsMynews.html" style=" color: black;"><i class="layui-icon" style="font-size: 20px; ">&#xe68e;</i> 我的信息</a>
				</li>
				<li class="layui-nav-item">
					<a href="memberNewsMychange.html" style=" color: black;"><i class="layui-icon" style="font-size: 20px;">&#xe620;</i> 修改资料</a>
				</li>
				<li class="layui-nav-item">
					<a href="memberNewsMypassword.html" style=" color: black;"><i class="layui-icon" style="font-size: 20px;"> &#xe673;</i> 修改密码</a>
				</li>

			</ul>

			<div style="float: right;">
				<div class="layui-container " style=" width: 980px; padding: 30px 0 30px 0; background-color:rgb(238,238,238,0.5);">
					<div class="layui-container" style=" width: 600px; margin: 0 auto;">
						<form class="layui-form layui-form-pane " action="">
							<div class="layui-form-item">
								<label class="layui-form-label">ID</label>
								<div class="layui-input-block">
									<input type="text" name="id" disabled=“disabled” lay-verify="required" id="id" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">姓名</label>
								<div class="layui-input-block">
									<input type="text" name="name" required lay-verify="required" id="name" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">专业</i></label>
								<div class="layui-input-block">
									<input type="text" name="major" required lay-verify="required" id="major" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">年级</i></label>
								<div class="layui-input-block">
									<input type="text" name="grade" required lay-verify="required" id="grade" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">QQ</i></label>
								<div class="layui-input-block">
									<input type="text" name="qq" required lay-verify="required" id="qq" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">宿舍号</i></label>
								<div class="layui-input-block">
									<input type="text" name="dormitory" required lay-verify="required" id="dormitory" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">手机号</i></label>
								<div class="layui-input-block">
									<input type="text" name="phone" required lay-verify="required/phone" id="phone" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">学院</label>
								<div class="layui-input-block">
									<input type="text" name="college" required lay-verify="required" id="college" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">政治面貌</label>
								<div class="layui-input-block">
									<select name="political" required lay-verify="required" id="political">
										<option value="">请选择政治面貌</option>
										<option value="党员">党员</option>
										<option value="团员">团员</option>
										<option value="群众">群众</option>
									</select>
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">职务</label>
								<div class="layui-input-block">
									<!--<select name="post" required lay-verify="required" id="post" disabled=“disabled”>
										<option value="">请选择报名职务</option>
										<option value="理事">理事</option>
										<option value="会员">会员</option>
									</select>-->
									<input type="text" name="post" disabled=“disabled” lay-verify="required" id="post" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">会员编号</label>
								<div class="layui-input-block">
									<input type="text" name="memid" disabled=“disabled” lay-verify="required" id="memid" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">学号</label>
								<div class="layui-input-block">
									<input type="text" name="stunum" disabled=“disabled” lay-verify="required" id="stunum" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">活动等级</label>
								<div class="layui-input-block">
									<input type="text" name="activityLevel" disabled=“disabled” lay-verify="required" id="activityLevel" autocomplete="off" class="layui-input">
								</div>
							</div>
							<div class="layui-form-item">
								<label class="layui-form-label">考评等级</label>
								<div class="layui-input-block">
									<input type="text" name="assessmentGrade" disabled=“disabled” lay-verify="required" id="assessmentGrade" autocomplete="off" class="layui-input">
								</div>
							</div>

							<div class="layui-form-item">
								<div class="layui-input-block">
									<button class="layui-btn" lay-submit lay-filter="change">修改</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>

		</div>

	</body>

	<script src="../res/layui/layui.js"></script>
	<script>
		//注意：导航 依赖 element 模块，否则无法进行功能性操作

		layui.use(['form', 'element', 'layer', 'jquery'], function() {

			var layer = layui.layer;
			var form = layui.form;
			var element = layui.element;
			var $ = layui.$;
			var path = sessionStorage.getItem('path');
			//验证信息
			form.verify({
				name: function(value) {
					if(value.length == 0) {
						return '姓名不能为空';
					}
					if(value.length < 2 && value.length > 0) {
						return '姓名至少为两个字';
					}
					if(!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)) {
						return '用户名不能有特殊字符';
					}
					if(/(^\_)|(\__)|(\_+$)/.test(value)) {
						return '用户名首尾不能出现下划线\'_\'';
					}

				},
				stunum: function(value) {
					if(value.length == 0) {
						return '学号不能为空';
					}
					if(value.length != 12) {
						return '学号必须为12位';
					}
					if(!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)) {
						return '学号不能有特殊字符';
					}
					if(/(^\_)|(\__)|(\_+$)/.test(value)) {
						return '学号首尾不能出现下划线\'_\'';
					}

				},
				grade: [
					/^[\S]{4}$/, '年级格式eg：2017'
				],
				phone: [
					/^\d{11}$/, '手机号码不正确'
				],

				qq: [
					/^\d{5,10}$/, 'QQ输入不正确'
				],

			});

			//监听提交
			form.on('submit(change)', function(data) {

				$.ajax({
					type: "post",
					url: path + "/api/user/update",
					data: data.field,
					dataType: 'JSON',
					success: function(res) {
						//注册成功
						layer.alert("修改成功");
					}

				});
				return false;

			});

			//获取后端显示数据

			var obj = JSON.parse(sessionStorage.getItem('user'));
			console.log(obj);
			console.log(obj.name);

			//显示信息设置value值
			$("#id").val(obj.id);
			$("#name ").val(obj.name);
			$("#major").val(obj.major);
			$("#grade").val(obj.grade);
			$("#qq").val(obj.qq);
			$("#dormitory").val(obj.dormitory);
			$("#phone").val(obj.phone);
			$("#college").val(obj.college);
			$('#political').find('option[value=' + obj.political + ']').prop("selected", true);
			$("#post").val(obj.post);
			$("#memid").val(obj.memid);
			$("#stunum").val(obj.stunum);
			$("#activityLevel").val(obj.activityLevel);
			$("#assessmentGrade").val(obj.assessmentGrade);
			$("#stupwd").val(obj.stupwd);
			$("#loginCount").val(obj.loginCount);

			element.on('nav(myNews)', function(elem) {
				console.log(11);
				layer.msg("我的信息");
			});
		});
	</script>

</html>